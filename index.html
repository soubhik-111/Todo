<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">
    <title>ToDo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        #container {
            height: 100%;
            min-height: 30vh;
            width: 100%;
            justify-content: space-around;
            max-width: 70vw;
            margin: 0 auto;
        }

        #container input {
            height: 100%;
            max-height: 6vh;
            width: 100%;
        }
    </style>
</head>

<body>

    <div id="container" class="input-group flex-nowrap flex-column">
        <input type="text" class="form-control" id="taskTitle" placeholder="Enter Task Title" aria-label="Username"
            aria-describedby="addon-wrapping">
        <input type="text" class="form-control" id="taskDescription" placeholder="Enter Task Description"
            aria-label="Username" aria-describedby="addon-wrapping">
        <button class="btn btn-primary rounded-pill" value="ADD" onclick="addBtn()">ADD</button>
    </div>
    <table class="table table-dark table-striped justify-content-around d-flex" id="table">
        <tbody id="tableBody">
            <tr>
                <th>S.no.</th>
                <th>Title</th>
                <th>Description</th>
                <th>Delete</th>
            </tr>
        </tbody>
    </table>

    <script>
        let data = []
        let data2 = 0

        function checkEmpty(title, description) {
            if (title === "" && description === "") {
                alert("Title and Description both can't be empty")
                return false
            }
            else if (title === "") {
                alert("Title can't be empty");
                return false
            }
            else if (description === "") {
                alert("Description can't be empty");
                return false
            }
            else {
                return true
            }
        }
        // function deleting(x) {
        //     x = x - 1
        //     console.log(x)
        //     let someData = localStorage.getItem('data');
        //     someData = JSON.parse(someData);
        //     console.log(typeof (someData));
        //     let newArr;
        //     newArr = someData.forEach((ele) => {
        //         console.log(ele);
        //         if (x != ele.sno) {
        //             return ele;
        //         }
        //     })
        // }
        function deleting(x) {
            x = x - 1
            console.log(x)
            let someData = localStorage.getItem('data');
            someData = JSON.parse(someData);
            console.log(typeof (someData));
            let newArr;
            newArr = someData.forEach((ele) => {
                console.log(ele);
                if (x != ele.sno) {
                    return ele;
                }
            })
        }

        const addContainer = (e) => {
            const tr = document.createElement('tr')
            tr.innerHTML = `<tr>
                <td>${e.sno} .</td>
                <td>${e.title}</td>
                <td>${e.description}</td>
                <td style="text-align :center"><i class="bi bi-file-earmark-x-fill" onclick="deleting(${e.sno})"></i></td>
            </tr>`
            const ele = document.getElementById("tableBody");
            ele.append(tr)
        }



        const body = document.querySelector("body")
        body.addEventListener("loadeddata", reload())
        function reload() {
            let temp
            temp = JSON.parse(localStorage.getItem('data'));
            if (temp != 0) {
                console.log("data2 !+ 0")
                prev = temp
                data = data.concat(temp);
                if (temp !== null) {
                    temp.map((e) => {
                        addContainer(e)
                    }
                    )
                }
            }
        }


        const addBtn = () => {
            let title = document.getElementById("taskTitle").value;
            let description = document.getElementById("taskDescription").value;

            if (checkEmpty(title, description) === true) {
                let myObject = {
                    sno: data.length + 1,
                    title: title,
                    description: description
                }
                data.push(myObject)
                localStorage.setItem('data', JSON.stringify(data));
                addContainer(myObject)
            }
            document.getElementById("taskTitle").value = ""
            document.getElementById("taskDescription").value = ""

        }
        // todo 1 : retrive data from local storage
        // todo 2 : if data retrived from local storage is not empty AND data array is empty => put the data from local storage into the data array
    </script>
</body>

</html>
